# Architecture

```mermaid
graph TD;
  %% Aliases
  client[Client browser]
  vetoFE[Veto Application]
  vetoBE[Veto API]
  vetoScreen[Hardware screen]
  vetoSetupFE[Setup Application]
  vetoSetupBE[Setup API]
  vetoSetup[Setup script]
  cyphernode[Cyphernode API]

  %% Veto core application
  client--> vetoFE
  vetoFE --> vetoBE
  vetoBE --> cyphernode

  %% Veto screen
  vetoScreen --> vetoBE

  %% Veto setup and update
  client --> vetoSetupFE
  vetoSetupFE --> vetoSetupBE
  vetoSetupBE --> vetoSetup
  vetoFE --> vetoSetupFE
```

<svg id="mermaid-1584909364552" width="439.86669921875" xmlns="http://www.w3.org/2000/svg" height="409.1666259765625" viewBox="0 0 439.86669921875 409.1666259765625">
    <style> #mermaid-1584909364552 .label { font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); color: #333; } #mermaid-1584909364552 .label text { fill: #333; } #mermaid-1584909364552 .node rect, #mermaid-1584909364552 .node circle, #mermaid-1584909364552 .node ellipse, #mermaid-1584909364552 .node polygon, #mermaid-1584909364552 .node path { fill: #ECECFF; stroke: #9370DB; stroke-width: 1px; } #mermaid-1584909364552 .node .label { text-align: center; } #mermaid-1584909364552 .node.clickable { cursor: pointer; } #mermaid-1584909364552 .arrowheadPath { fill: #333333; } #mermaid-1584909364552 .edgePath .path { stroke: #333333; stroke-width: 1.5px; } #mermaid-1584909364552 .edgeLabel { background-color: #e8e8e8; text-align: center; } #mermaid-1584909364552 .cluster rect { fill: #ffffde; stroke: #aaaa33; stroke-width: 1px; } #mermaid-1584909364552 .cluster text { fill: #333; } #mermaid-1584909364552 div.mermaidTooltip { position: absolute; text-align: center; max-width: 200px; padding: 2px; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); font-size: 12px; background: #ffffde; border: 1px solid #aaaa33; border-radius: 2px; pointer-events: none; z-index: 100; } #mermaid-1584909364552 .actor { stroke: #CCCCFF; fill: #ECECFF; } #mermaid-1584909364552 text.actor { fill: black; stroke: none; } #mermaid-1584909364552 .actor-line { stroke: grey; } #mermaid-1584909364552 .messageLine0 { stroke-width: 1.5; stroke-dasharray: '2 2'; stroke: #333; } #mermaid-1584909364552 .messageLine1 { stroke-width: 1.5; stroke-dasharray: '2 2'; stroke: #333; } #mermaid-1584909364552 #arrowhead { fill: #333; } #mermaid-1584909364552 .sequenceNumber { fill: white; } #mermaid-1584909364552 #sequencenumber { fill: #333; } #mermaid-1584909364552 #crosshead path { fill: #333 !important; stroke: #333 !important; } #mermaid-1584909364552 .messageText { fill: #333; stroke: none; } #mermaid-1584909364552 .labelBox { stroke: #CCCCFF; fill: #ECECFF; } #mermaid-1584909364552 .labelText { fill: black; stroke: none; } #mermaid-1584909364552 .loopText { fill: black; stroke: none; } #mermaid-1584909364552 .loopLine { stroke-width: 2; stroke-dasharray: '2 2'; stroke: #CCCCFF; } #mermaid-1584909364552 .note { stroke: #aaaa33; fill: #fff5ad; } #mermaid-1584909364552 .noteText { fill: black; stroke: none; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); font-size: 14px; } #mermaid-1584909364552 .activation0 { fill: #f4f4f4; stroke: #666; } #mermaid-1584909364552 .activation1 { fill: #f4f4f4; stroke: #666; } #mermaid-1584909364552 .activation2 { fill: #f4f4f4; stroke: #666; } #mermaid-1584909364552 .mermaid-main-font { font-family: "trebuchet ms", verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 .section { stroke: none; opacity: 0.2; } #mermaid-1584909364552 .section0 { fill: rgba(102, 102, 255, 0.49); } #mermaid-1584909364552 .section2 { fill: #fff400; } #mermaid-1584909364552 .section1, #mermaid-1584909364552 .section3 { fill: white; opacity: 0.2; } #mermaid-1584909364552 .sectionTitle0 { fill: #333; } #mermaid-1584909364552 .sectionTitle1 { fill: #333; } #mermaid-1584909364552 .sectionTitle2 { fill: #333; } #mermaid-1584909364552 .sectionTitle3 { fill: #333; } #mermaid-1584909364552 .sectionTitle { text-anchor: start; font-size: 11px; text-height: 14px; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 .grid .tick { stroke: lightgrey; opacity: 0.8; shape-rendering: crispEdges; } #mermaid-1584909364552   .grid .tick text { font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 .grid path { stroke-width: 0; } #mermaid-1584909364552 .today { fill: none; stroke: red; stroke-width: 2px; } #mermaid-1584909364552 .task { stroke-width: 2; } #mermaid-1584909364552 .taskText { text-anchor: middle; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 .taskText:not([font-size]) { font-size: 11px; } #mermaid-1584909364552 .taskTextOutsideRight { fill: black; text-anchor: start; font-size: 11px; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 .taskTextOutsideLeft { fill: black; text-anchor: end; font-size: 11px; } #mermaid-1584909364552 .task.clickable { cursor: pointer; } #mermaid-1584909364552 .taskText.clickable { cursor: pointer; fill: #003163 !important; font-weight: bold; } #mermaid-1584909364552 .taskTextOutsideLeft.clickable { cursor: pointer; fill: #003163 !important; font-weight: bold; } #mermaid-1584909364552 .taskTextOutsideRight.clickable { cursor: pointer; fill: #003163 !important; font-weight: bold; } #mermaid-1584909364552 .taskText0, #mermaid-1584909364552 .taskText1, #mermaid-1584909364552 .taskText2, #mermaid-1584909364552 .taskText3 { fill: white; } #mermaid-1584909364552 .task0, #mermaid-1584909364552 .task1, #mermaid-1584909364552 .task2, #mermaid-1584909364552 .task3 { fill: #8a90dd; stroke: #534fbc; } #mermaid-1584909364552 .taskTextOutside0, #mermaid-1584909364552 .taskTextOutside2 { fill: black; } #mermaid-1584909364552 .taskTextOutside1, #mermaid-1584909364552 .taskTextOutside3 { fill: black; } #mermaid-1584909364552 .active0, #mermaid-1584909364552 .active1, #mermaid-1584909364552 .active2, #mermaid-1584909364552 .active3 { fill: #bfc7ff; stroke: #534fbc; } #mermaid-1584909364552 .activeText0, #mermaid-1584909364552 .activeText1, #mermaid-1584909364552 .activeText2, #mermaid-1584909364552 .activeText3 { fill: black !important; } #mermaid-1584909364552 .done0, #mermaid-1584909364552 .done1, #mermaid-1584909364552 .done2, #mermaid-1584909364552 .done3 { stroke: grey; fill: lightgrey; stroke-width: 2; } #mermaid-1584909364552 .doneText0, #mermaid-1584909364552 .doneText1, #mermaid-1584909364552 .doneText2, #mermaid-1584909364552 .doneText3 { fill: black !important; } #mermaid-1584909364552 .crit0, #mermaid-1584909364552 .crit1, #mermaid-1584909364552 .crit2, #mermaid-1584909364552 .crit3 { stroke: #ff8888; fill: red; stroke-width: 2; } #mermaid-1584909364552 .activeCrit0, #mermaid-1584909364552 .activeCrit1, #mermaid-1584909364552 .activeCrit2, #mermaid-1584909364552 .activeCrit3 { stroke: #ff8888; fill: #bfc7ff; stroke-width: 2; } #mermaid-1584909364552 .doneCrit0, #mermaid-1584909364552 .doneCrit1, #mermaid-1584909364552 .doneCrit2, #mermaid-1584909364552 .doneCrit3 { stroke: #ff8888; fill: lightgrey; stroke-width: 2; cursor: pointer; shape-rendering: crispEdges; } #mermaid-1584909364552 .milestone { transform: rotate(45deg) scale(0.8, 0.8); } #mermaid-1584909364552 .milestoneText { font-style: italic; } #mermaid-1584909364552 .doneCritText0, #mermaid-1584909364552 .doneCritText1, #mermaid-1584909364552 .doneCritText2, #mermaid-1584909364552 .doneCritText3 { fill: black !important; } #mermaid-1584909364552 .activeCritText0, #mermaid-1584909364552 .activeCritText1, #mermaid-1584909364552 .activeCritText2, #mermaid-1584909364552 .activeCritText3 { fill: black !important; } #mermaid-1584909364552 .titleText { text-anchor: middle; font-size: 18px; fill: black; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 g.classGroup text { fill: #9370DB; stroke: none; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); font-size: 10px; } #mermaid-1584909364552   g.classGroup text .title { font-weight: bolder; } #mermaid-1584909364552 g.clickable { cursor: pointer; } #mermaid-1584909364552 g.classGroup rect { fill: #ECECFF; stroke: #9370DB; } #mermaid-1584909364552 g.classGroup line { stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 .classLabel .box { stroke: none; stroke-width: 0; fill: #ECECFF; opacity: 0.5; } #mermaid-1584909364552 .classLabel .label { fill: #9370DB; font-size: 10px; } #mermaid-1584909364552 .relation { stroke: #9370DB; stroke-width: 1; fill: none; } #mermaid-1584909364552 .dashed-line { stroke-dasharray: 3; } #mermaid-1584909364552 #compositionStart { fill: #9370DB; stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 #compositionEnd { fill: #9370DB; stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 #aggregationStart { fill: #ECECFF; stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 #aggregationEnd { fill: #ECECFF; stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 #dependencyStart { fill: #9370DB; stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 #dependencyEnd { fill: #9370DB; stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 #extensionStart { fill: #9370DB; stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 #extensionEnd { fill: #9370DB; stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 .commit-id, #mermaid-1584909364552 .commit-msg, #mermaid-1584909364552 .branch-label { fill: lightgrey; color: lightgrey; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 .pieTitleText { text-anchor: middle; font-size: 25px; fill: black; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 .slice { font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 g.stateGroup text { fill: #9370DB; stroke: none; font-size: 10px; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } #mermaid-1584909364552 g.stateGroup text { fill: #9370DB; stroke: none; font-size: 10px; } #mermaid-1584909364552 g.stateGroup .state-title { font-weight: bolder; fill: black; } #mermaid-1584909364552 g.stateGroup rect { fill: #ECECFF; stroke: #9370DB; } #mermaid-1584909364552 g.stateGroup line { stroke: #9370DB; stroke-width: 1; } #mermaid-1584909364552 .transition { stroke: #9370DB; stroke-width: 1; fill: none; } #mermaid-1584909364552 .stateGroup .composit { fill: white; border-bottom: 1px; } #mermaid-1584909364552 .stateGroup .alt-composit { fill: #e0e0e0; border-bottom: 1px; } #mermaid-1584909364552 .state-note { stroke: #aaaa33; fill: #fff5ad; } #mermaid-1584909364552   .state-note text { fill: black; stroke: none; font-size: 10px; } #mermaid-1584909364552 .stateLabel .box { stroke: none; stroke-width: 0; fill: #ECECFF; opacity: 0.5; } #mermaid-1584909364552 .stateLabel text { fill: black; font-size: 10px; font-weight: bold; font-family: 'trebuchet ms', verdana, arial; font-family: var(--mermaid-font-family); } :root { --mermaid-font-family: '"trebuchet ms", verdana, arial'; --mermaid-font-family: "Comic Sans MS", "Comic Sans", cursive; } :root { --mermaid-font-family: "trebuchet ms", verdana, arial;}</style><style>#mermaid-1584909364552 { color: rgb(0, 0, 0); font: ; }</style>
    <g transform="translate(0, 0)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M143.7656823509882,46.633331298828125L172.64167022705078,71.63333129882812L172.64167022705078,96.63333129882812" marker-end="url(#arrowhead28)" style="fill:none"></path><defs><marker id="arrowhead28" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M209.32081609809347,135.26666259765625L256.7916717529297,160.26666259765625L309.9037460404521,185.26666259765625" marker-end="url(#arrowhead29)" style="fill:none"></path><defs><marker id="arrowhead29" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M350.9416732788086,223.89999389648438L350.9416732788086,248.89999389648438L350.9416732788086,273.8999938964844" marker-end="url(#arrowhead30)" style="fill:none"></path><defs><marker id="arrowhead30" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M360.9416732788086,135.26666259765625L360.9416732788086,160.26666259765625L355.3004546461224,185.26666259765625" marker-end="url(#arrowhead31)" style="fill:none"></path><defs><marker id="arrowhead31" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M99.14265810311338,46.633331298828125L70.26667022705078,71.63333129882812L70.26667022705078,115.94999694824219L70.26667022705078,160.26666259765625L75.907888859737,185.26666259765625" marker-end="url(#arrowhead32)" style="fill:none"></path><defs><marker id="arrowhead32" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M80.26667022705078,223.89999389648438L80.26667022705078,248.89999389648438L80.26667022705078,273.8999938964844" marker-end="url(#arrowhead33)" style="fill:none"></path><defs><marker id="arrowhead33" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M80.26667022705078,312.5333251953125L80.26667022705078,337.5333251953125L80.26667022705078,362.5333251953125" marker-end="url(#arrowhead34)" style="fill:none"></path><defs><marker id="arrowhead34" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M154.68893947042716,135.26666259765625L131.45417022705078,160.26666259765625L102.57818235098819,185.26666259765625" marker-end="url(#arrowhead35)" style="fill:none"></path><defs><marker id="arrowhead35" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node" style="opacity: 1;" id="client" transform="translate(121.45417022705078,27.316665649414062)"><rect rx="0" ry="0" x="-61.133331298828125" y="-19.316665649414062" width="122.26666259765625" height="38.633331298828125" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-51.133331298828125,-9.316665649414062)"><foreignObject width="102.26666259765625" height="18.633331298828125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Client browser</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="vetoFE" transform="translate(172.64167022705078,115.94999694824219)"><rect rx="0" ry="0" x="-67.375" y="-19.316665649414062" width="134.75" height="38.633331298828125" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-57.375,-9.316665649414062)"><foreignObject width="114.75" height="18.633331298828125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Veto Application</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="vetoBE" transform="translate(350.9416732788086,204.5833282470703)"><rect rx="0" ry="0" x="-41.133331298828125" y="-19.316665649414062" width="82.26666259765625" height="38.633331298828125" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-31.133331298828125,-9.316665649414062)"><foreignObject width="62.26666259765625" height="18.633331298828125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Veto API</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="vetoScreen" transform="translate(360.9416732788086,115.94999694824219)"><rect rx="0" ry="0" x="-70.92500305175781" y="-19.316665649414062" width="141.85000610351562" height="38.633331298828125" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-60.92500305175781,-9.316665649414062)"><foreignObject width="121.85000610351562" height="18.633331298828125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Hardware screen</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="vetoSetupFE" transform="translate(80.26667022705078,204.5833282470703)"><rect rx="0" ry="0" x="-72.26667022705078" y="-19.316665649414062" width="144.53334045410156" height="38.633331298828125" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-62.26667022705078,-9.316665649414062)"><foreignObject width="124.53334045410156" height="18.633331298828125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Setup Application</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="vetoSetupBE" transform="translate(80.26667022705078,293.21665954589844)"><rect rx="0" ry="0" x="-46.025001525878906" y="-19.316665649414062" width="92.05000305175781" height="38.633331298828125" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-36.025001525878906,-9.316665649414062)"><foreignObject width="72.05000305175781" height="18.633331298828125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Setup API</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="vetoSetup" transform="translate(80.26667022705078,381.84999084472656)"><rect rx="0" ry="0" x="-52.25" y="-19.316665649414062" width="104.5" height="38.633331298828125" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-42.25,-9.316665649414062)"><foreignObject width="84.5" height="18.633331298828125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Setup script</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="cyphernode" transform="translate(350.9416732788086,293.21665954589844)"><rect rx="0" ry="0" x="-68.70833587646484" y="-19.316665649414062" width="137.4166717529297" height="38.633331298828125" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-58.708335876464844,-9.316665649414062)"><foreignObject width="117.41667175292969" height="18.633331298828125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Cyphernode API</div></foreignObject></g></g></g></g></g></g>
</svg>

## Key points

- Backend serve front-end as static content
- Aside from serving static content, the backend is purely an API

### Difference between dev & prod

#### Serving the front end

In dev, the front-end has its own server with `hot-reload` and `watch` capability. The backend serves it using a proxy.

In prod, the front-end is fully static. The backend statically serve theses files instead of using a proxy.

## Backend Structure

The folder structure is used to make a distinction between route implementation `api/*` and core server utils `server/*`
This has the effect of making tests easy as routes do not depend on server.

- `routes/` Contains veto routes, each file is a route veto-frontend can call to. \* `getActiveWatches.ts` handle the request (call upstream api, handle errors, format messages, etc)
- `api/` Contains api calls, sub-folders are grouped by upstream service
  - `cyphernode/` Group all calls to cyphernode, each file in this folder handle one call to cyphernode
    - `getActiveWatches.ts` make a `get` call to cyphernode `activewatches` endpoint
    - `client.ts` Provide an axios client with everything needed to call cyphernode
- `server/` Holds all core server code
  - `middlewares/` Group all middlewares used in this app, each file contain one middleware
    - `index.ts` Setup all middlewares in order
  - `serveFrontend.ts` (might be moved later) Serve static files. Used to serve veto-frontend
  - `index.ts` Brings all parts of the server together (middleware, api routes, serve frontend, etc)
- `utils/` Holds all utils used in the whole app (ex: config & logging)
